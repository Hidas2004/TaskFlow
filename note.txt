Database -> Repo -> Service -> Handler -> Routes.

////////////////////////////////////////////////////////

1. *gin.RouterGroup (Ng∆∞·ªùi t·ªï ch·ª©c ƒë∆∞·ªùng ƒëi)
ƒê√¢y l√† c√¥ng c·ª• gi√∫p b·∫°n gom nh√≥m c√°c ƒë∆∞·ªùng d·∫´n (URL) c√≥ chung m·ª•c ƒë√≠ch ho·∫∑c chung ƒë·∫∑c ƒëi·ªÉm l·∫°i v·ªõi nhau.
T√°c d·ª•ng ch√≠nh:
T·ªï ch·ª©c code: Gi√∫p API kh√¥ng b·ªã l·ªôn x·ªôn. V√≠ d·ª•: t√°ch ri√™ng API cho Admin v√† API cho User.
G·∫Øn Middleware chung: B·∫°n c√≥ th·ªÉ b·∫Øt bu·ªôc t·∫•t c·∫£ c√°c API trong m·ªôt nh√≥m ph·∫£i ƒëi qua m·ªôt b∆∞·ªõc ki·ªÉm tra (v√≠ d·ª•: nh√≥m /admin b·∫Øt bu·ªôc ph·∫£i ƒëƒÉng nh·∫≠p).
K·∫ø th·ª´a: B·∫£n th√¢n bi·∫øn r := gin.Default() ch√≠nh l√† m·ªôt RouterGroup l·ªõn nh·∫•t (root).

/////////////////////////////////////////////////

2. *gin.Context (Ng∆∞·ªùi v·∫≠n chuy·ªÉn d·ªØ li·ªáu)
ƒê√¢y l√† ph·∫ßn quan tr·ªçng nh·∫•t trong m·ªôt h√†m x·ª≠ l√Ω (Handler). M·ªói khi c√≥ m·ªôt ng∆∞·ªùi d√πng g·ª≠i y√™u c·∫ßu (Request) ƒë·∫øn server, Gin s·∫Ω t·∫°o ra m·ªôt Context ri√™ng bi·ªát cho y√™u c·∫ßu ƒë√≥.
T√°c d·ª•ng ch√≠nh:
Ch·ª©a th√¥ng tin Request: L·∫•y d·ªØ li·ªáu ng∆∞·ªùi d√πng g·ª≠i l√™n (Header, JSON body, Query params, URL params).
G·ª≠i tr·∫£ Response: Tr·∫£ v·ªÅ k·∫øt qu·∫£ cho ng∆∞·ªùi d√πng (JSON, HTML, String, File).
ƒêi·ªÅu khi·ªÉn lu·ªìng (Flow Control): D√πng ƒë·ªÉ chuy·ªÉn ti·∫øp sang middleware ti·∫øp theo (Next()) ho·∫∑c d·ª´ng l·∫°i ngay l·∫≠p t·ª©c (Abort()).
L∆∞u tr·ªØ t·∫°m th·ªùi: Truy·ªÅn d·ªØ li·ªáu gi·ªØa c√°c middleware v·ªõi nhau (v√≠ d·ª•: Middleware x√°c th·ª±c t√¨m th·∫•y userID, n√≥ l∆∞u v√†o Context ƒë·ªÉ h√†m x·ª≠ l√Ω ch√≠nh l·∫•y ra d√πng).


////////////////////////////////////////////////
3. constructor
Trong Golang (Go) kh√¥ng c√≥ constructor theo nghƒ©a truy·ªÅn th·ªëng nh∆∞ trong Java hay C++.
üëâ Thay v√†o ƒë√≥, Go d√πng h√†m kh·ªüi t·∫°o t·ª± ƒë·ªãnh nghƒ©a (factory function) ƒë·ªÉ t·∫°o v√† kh·ªüi t·∫°o struct.
1Ô∏è‚É£ V√¨ sao Go kh√¥ng c√≥ constructor?
Go ƒë∆°n gi·∫£n h√≥a ng√¥n ng·ªØ
Kh√¥ng c√≥ class ‚Üí ch·ªâ c√≥ struct
Kh√¥ng c√≥ h√†m t·ª± ƒë·ªông ch·∫°y khi t·∫°o object
2Ô∏è‚É£ Constructor trong Golang l√† g√¨?
üëâ Constructor trong Go l√† m·ªôt h√†m th∆∞·ªùng, c√≥ nhi·ªám v·ª•:
T·∫°o struct
G√°n gi√° tr·ªã ban ƒë·∫ßu
Tr·∫£ v·ªÅ struct ho·∫∑c con tr·ªè struct

///////////////////////////////////////////////

4 JWT
1. T·∫°i sao c·∫ßn ƒëo·∫°n code n√†y? (V·∫•n ƒë·ªÅ)
B√¨nh th∆∞·ªùng, khi kh√°ch (User) mu·ªën v√†o ch∆°i t√†u l∆∞·ª£n, h·ªç ph·∫£i mua v√©.
N·∫øu kh√¥ng c√≥ JWT: M·ªói l·∫ßn kh√°ch mu·ªën ch∆°i m·ªôt tr√≤, nh√¢n vi√™n so√°t v√© ph·∫£i g·ªçi ƒëi·ªán v·ªÅ t·ªïng ƒë√†i (Database) ƒë·ªÉ h·ªèi: "Alo, √¥ng H√πng n√†y ƒë√£ mua v√© ch∆∞a? Mua lo·∫°i v√© VIP hay th∆∞·ªùng?".
=> H·∫≠u qu·∫£: T·ªïng ƒë√†i ngh·∫Ωn m·∫°ng, kh√°ch ch·ªù l√¢u, server ch·∫°y ch·∫≠m.
2. JWT gi·∫£i quy·∫øt th·∫ø n√†o? (Gi·∫£i ph√°p)
ƒêo·∫°n code b·∫°n g·ª≠i ch√≠nh l√† c√°i m√°y In V√≤ng Tay Gi·∫•y (lo·∫°i v√≤ng ƒëeo tay ƒëi s·ª± ki·ªán ·∫•y).
GenerateToken (H√†m 1): Khi H√πng ƒëƒÉng nh·∫≠p th√†nh c√¥ng l·∫ßn ƒë·∫ßu, h·ªá th·ªëng in cho H√πng m·ªôt c√°i v√≤ng tay. Tr√™n v√≤ng ghi r√µ: "T√™n: H√πng, Quy·ªÅn: Admin, H·∫øt h·∫°n: 5 gi·ªù chi·ªÅu". Sau ƒë√≥ ƒë√≥ng d·∫•u ƒë·ªè (k√Ω t√™n) c·ªßa c√¥ng vi√™n l√™n ƒë√≥.
ValidateToken (H√†m 2): L·∫ßn sau H√πng mu·ªën ch∆°i tr√≤ ch∆°i, ch·ªâ c·∫ßn gi∆° c·ªï tay ra. Nh√¢n vi√™n nh√¨n c√°i v√≤ng, th·∫•y d·∫•u ƒë·ªè x·ªãn (kh√¥ng b·ªã t·∫©y x√≥a), th·∫•y ch∆∞a h·∫øt h·∫°n => Cho v√†o lu√¥n. Kh√¥ng c·∫ßn g·ªçi t·ªïng ƒë√†i n·ªØa.

////////////////////////////////////////////////
5. ctx.ShouldBindJSON(&input)
h√†m n√†y c·ªßa gin s·∫Ω ƒë·ªçc json t·ª´ body c·ªßa Request
n√≥ map √°nh x·∫° d·ªØ li·ªáu v√†o bi·∫øn input
n√≥ ki·ªÉm tra c√°c tag validate (VD binding"required,email") n·∫øu c√≥ trong DTO
(*) X·ª¨ l√Ω l·ªói : n·∫øu JSON sai ƒë·ªãnh d·∫°ng ho·∫∑c thi·∫øu tr∆∞·ªùng field b·∫Øt bu·ªôc n√≥ g·ªçi uitils.ErrorResponse
tr·∫£ v·ªÅ m√£ 400 bad request

/////////////////////////////////////////////

"√Ånh x·∫° d·ªØ li·ªáu sang Model"
1. "L√† sao?" (V·ªÅ m·∫∑t k·ªπ thu·∫≠t)
DTO (Data Transfer Object - req): L√† c√°i t√∫i ch·ª©a d·ªØ li·ªáu m√† ng∆∞·ªùi d√πng g·ª≠i l√™n t·ª´ giao di·ªán (Frontend). N√≥ th∆∞·ªùng ch·ªâ ch·ª©a nh·ªØng th√¥ng tin c∆° b·∫£n nh∆∞ Email, Password, FullName.

Model (models.User): L√† c·∫•u tr√∫c ƒë·∫°i di·ªán cho m·ªôt h√†ng (row) trong b·∫£ng d·ªØ li·ªáu c·ªßa c∆° s·ªü d·ªØ li·ªáu (Database). N√≥ ch·ª©a ƒë·∫ßy ƒë·ªß c√°c tr∆∞·ªùng th√¥ng tin c·∫ßn thi·∫øt ƒë·ªÉ l∆∞u tr·ªØ, bao g·ªìm c·∫£ nh·ªØng th√¥ng tin m√† ng∆∞·ªùi d√πng kh√¥ng g·ª≠i l√™n (nh∆∞ ID, Role, CreatedAt, v.v.).

H√†nh ƒë·ªông √°nh x·∫° ch√≠nh l√† vi·ªác b·∫°n l·∫•y c√°c gi√° tr·ªã t·ª´ req (DTO) v√† g√°n v√†o c√°c thu·ªôc t√≠nh t∆∞∆°ng ·ª©ng c·ªßa m·ªôt ƒë·ªëi t∆∞·ª£ng newUser (Model).

Go

///////////////////////////////////////////////
jwt.io. l√† g√¨
jwt.io l√† m·ªôt trang web c√¥ng c·ª• c·ª±c k·ª≥ ph·ªï bi·∫øn (ƒë∆∞·ª£c ph√°t tri·ªÉn b·ªüi Auth0) d√†nh cho c√°c l·∫≠p tr√¨nh vi√™n Backend v√† Mobile.

N√≥i m·ªôt c√°ch ƒë∆°n gi·∫£n: N√≥ l√† c√°i "k√≠nh l√∫p" gi√∫p b·∫°n nh√¨n th·∫•u b√™n trong c√°i chu·ªói k√Ω t·ª± lo·∫±ng ngo·∫±ng (Token) m√† server Go c·ªßa b·∫°n v·ª´a tr·∫£ v·ªÅ.

T·∫°i sao b·∫°n c·∫ßn n√≥ l√∫c n√†y?
Khi API Login c·ªßa b·∫°n ch·∫°y th√†nh c√¥ng, n√≥ tr·∫£ v·ªÅ m·ªôt chu·ªói Token tr√¥ng gi·ªëng nh∆∞ th·∫ø n√†y: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9... (d√†i d·∫±ng d·∫∑c).

B·∫°n kh√¥ng th·ªÉ ƒë·ªçc hi·ªÉu chu·ªói n√†y b·∫±ng m·∫Øt th∆∞·ªùng. B·∫°n c·∫ßn jwt.io ƒë·ªÉ ki·ªÉm tra xem code c·ªßa b·∫°n ƒë√£ "g√≥i" ƒë√∫ng th√¥ng tin v√†o Token ch∆∞a.

//////////////////////////////////////////

hasprefix l√† ki·ªÉm tra chu·ªïi c√≥ b·∫Øt ƒë·∫ßu b·∫±ng 1 chu·ªói kh√°c kos
VD "bearer abx.cy" c√≥ b·∫Øt ƒë·∫ßu b·∫±ng bearer kos

HasSuffix ki·ªÉm tra chu·ªói c√≥ k·∫øt th√∫c b·∫±ng 1 chu·ªói kh√°c kh√¥ng
VD "image.png"  c√≥ k·∫øt th√∫c b·∫±ng .png ko